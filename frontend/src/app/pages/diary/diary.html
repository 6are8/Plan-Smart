<div class="diary-card">

  <h2>Evening Reflection âœï¸</h2>

  <!-- MOOD (2D Mood Circle + Emotion) -->
  <div class="mood2d">
    <span class="label">Choose your mood:</span>

    <div class="mood2d-layout">
      <div class="axis top">High energy</div>
      <div class="axis left">Unpleasant</div>

      <div
        class="mood2d-circle"
        #circle
        (pointerdown)="onCirclePointerDown($event)"
        (pointermove)="onCirclePointerMove($event)"
        (pointerup)="onCirclePointerUp()"
        (pointercancel)="onCirclePointerUp()"
        (lostpointercapture)="onCirclePointerUp()"
      >
        <div class="crosshair"></div>

        <div
          class="mood2d-dot"
          [style.left.%]="dotLeftPct"
          [style.top.%]="dotTopPct"
          [class.is-set]="moodIsSet"
        ></div>

        <!-- Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ°Ñ Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ·ĞºĞ° Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ -->
        <div class="mood2d-centerhint" *ngIf="!moodIsSet">
          Tap / drag
        </div>
      </div>

      <div class="axis right">Pleasant</div>
      <div class="axis bottom">Low energy</div>
    </div>

    <div class="mood2d-readout" [class.invalid]="moodTouched && !moodIsSet">
    <span class="mood-badge">
      <span class="mood-emoji">{{ moodEmoji }}</span>
      <b>{{ moodLabel }}</b>
    </span>

      <span class="hint error" *ngIf="moodTouched && !moodIsSet">Select your mood</span>
    </div>

    <div class="mood-presets">
      <button type="button" class="preset" (click)="setPreset('Excited')">âš¡ Excited</button>
      <button type="button" class="preset" (click)="setPreset('Happy')">ğŸ˜„ Happy</button>
      <button type="button" class="preset" (click)="setPreset('Calm')">ğŸ˜Œ Calm</button>
      <button type="button" class="preset" (click)="setPreset('Focused')">ğŸ¯ Focused</button>
      <button type="button" class="preset" (click)="setPreset('Tired')">ğŸ˜´ Tired</button>
      <button type="button" class="preset" (click)="setPreset('Sad')">ğŸ˜¢ Sad</button>
      <button type="button" class="preset" (click)="setPreset('Stressed')">ğŸ˜– Stressed</button>
      <button type="button" class="preset" (click)="setPreset('Angry')">ğŸ˜  Angry</button>
    </div>
  </div>

  <!-- FORM -->
  <form [formGroup]="form">

    <label>What went well today?</label>
    <textarea
      formControlName="good"
      placeholder="e.g. finished a presentation, 2Ã— focus sessionsâ€¦">
    </textarea>

    <label>What are the plans for tomorrow?</label>
    <textarea
      formControlName="improve"
      placeholder="go to bed earlier, reduce social mediaâ€¦">
    </textarea>

    <label>How do you feel right now?</label>
    <textarea
      formControlName="howIFeel"
      placeholder="e.g. motivated, tired, stressedâ€¦">
    </textarea>

     @if (errorMessage) {
    <p class="muted">{{ errorMessage }}</p>
    }

    <button type="button" (click)="submit()">
      Save
    </button>

    @if (successMessage) {
      <p class="success">{{ successMessage }}</p>
    }

  </form>

</div>
